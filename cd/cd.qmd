---
title: "í•­ê³µì‚¬ ì¶”ì²œ"
subtitle: "í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì¶”ì²œí•´ì¤„ top5 í•­ê³µì‚¬ ì„ ì •"
author: "ì´ì£¼ì—°, í•œê·œë¯¼, í™ì£¼í˜•, ì‹ ì§€ì› (4ì¡°)"

date: "2025-03-21"
format: 
  uark-revealjs:
    chalkboard: true
    embed-resources: false
    code-fold: false
    number-sections: false
    number-depth: 1
#jupyter: python3
---

## ëª©ì°¨

::: {.incremental}

1.  **ëª©ì  & ë°°ê²½**
2.  **5ëŒ€ í•­ê³µì‚¬ ì„ ì •**
    -   5ëŒ€ í•­ê³µì‚¬ ì„ ì • ê¸°ì¤€
    -   ë°ì´í„°ì…‹ ì†Œê°œ
    -   3 ê°œì˜ ê³µí•­ì—ì„œ ëª¨ë‘ ì¶œë°œí•˜ëŠ” í•­ê³µì‚¬
    -   í•­ê³µì‚¬ë³„ ìš´ì˜ íšŸìˆ˜
    -   í•­ê³µì‚¬ë³„ ë¹„í–‰ê±°ë¦¬
    -   í•­ê³µì‚¬ë³„ ë³´ìœ  í•­ê³µê¸° ìˆ˜
    -   í•­ê³µì‚¬ë³„ ì¢Œì„ ìˆ˜
3.  **ìµœì  í•­ê³µì‚¬ ì¶”ì²œ**
    -   ì¶”ì²œ ê¸°ì¤€ & ì ìˆ˜ ì‚°ì • ë°©ì‹
    -   ë‚ ì§œ ì „ì²˜ë¦¬
    -   í•­ê³µì‚¬ ë¶„ì„ - ì£¼ì¤‘
    -   í•­ê³µì‚¬ ë¶„ì„ - ì£¼ë§
    -   ê²°ë¡  (ì‹œê°í™”)
4.  **ì¡°ì› ë° ì—…ë¬´ ë¶„ë‹´**

:::

# ëª©ì  & ë°°ê²½

## ëª©ì  & ë°°ê²½

-   ìì‚¬(ìœ„ì¹˜: ë‰´ìš•)ë¥¼ ë°©ë¬¸í•œ í´ë¼ì´ì–¸íŠ¸ë“¤ì—ê²Œ **ê°ìì˜ ê³µí•­ìœ¼ë¡œ ëŒì•„ê°€ëŠ” ìµœì ì˜ í•­ê³µì‚¬ ì¶”ì²œ**ì„ ìœ„í•¨

<br>

- í•­ê³µì‚¬ë§ˆë‹¤ ìš´í•­ ë¹ˆë„, ë¹„í–‰ ê±°ë¦¬, ì •ì‹œ ìš´í•­ë¥ , ì§€ì—° ì‹œê°„ê³¼ ê°™ì€ ìš”ì†Œê°€ ë‹¬ë¼ **ì¢…í•©ì ì¸ ìµœì ì˜ í•­ê³µì‚¬** ì„ íƒ í•„ìš”

<br>

- **í´ë¼ì´ì–¸íŠ¸ë³„ ë‹ˆì¦ˆ**ë¥¼ ê³ ë ¤í•˜ì—¬ **í•­ê³µì‚¬ ì„ ì • ê¸°ì¤€ ì„¸ë¶„í™”** í•„ìš”



------------------------------------------------------------------------

# 5ëŒ€ í•­ê³µì‚¬ ì„ ì •

## 5ëŒ€ í•­ê³µì‚¬ ì„ ì • ê¸°ì¤€

-   **ìµœê·¼ ìš´ì˜ ì‹¤ì ì´ ì•ˆì •ì ì´ê³  ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” í•­ê³µì‚¬**
    -   ìš°ë¦¬ ì§€ì—­ì—ì„œ **í™œë°œíˆ ìš´ì˜**í•˜ëŠ” í•­ê³µì‚¬
    -   **ìš´ì˜ ê·œëª¨ê°€ í°** í•­ê³µì‚¬
        -   ìš´ì˜ íšŸìˆ˜ & ìš´ì˜ ê±°ë¦¬
        -   ë³´ìœ  í•­ê³µê¸° ìˆ˜
        -   ì¢Œì„ ìˆ˜ ![](seat.png){.absolute bottom="0" right="10" width="450" height="450"} ![](planes.png){.absolute bottom="0" right="520" width="450" height="450"} ![](ditance.png){.absolute bottom="0" right="1030" width="450" height="450"} ![](runtime.png){.absolute bottom="11" right="1540" width="450" height="450"}

------------------------------------------------------------------------

### ë°ì´í„°ì…‹ ì†Œê°œ

```{python echo=FALSE}
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from nycflights13 import flights, planes
import matplotlib
import numpy as np
pd.set_option('display.max_columns', None) 
pd.set_option('display.max_colwidth', None) 
# í•œê¸€ í°íŠ¸ ì„¤ì •
matplotlib.rc('font', family='Malgun Gothic')

# ë§ˆì´ë„ˆìŠ¤ ê¹¨ì§ ë°©ì§€
matplotlib.rcParams['axes.unicode_minus'] = False
```

```{python}
#| echo: True
merge_df = pd.merge(flights, planes, on='tailnum', how='left')
print(merge_df.head(2))
```

<br>

::: {.fragment style="display: flex; justify-content: flex-start;"}

|                        |                              |
|------------------------|------------------------------|
| **year_x, month, day** | í•­ê³µê¸° ì¶œë°œ ë‚ ì§œ(ë…„, ì›”, ì¼) |
| **dep_delay**          | ì¶œë°œ ì§€ì—° ì‹œê°„               |
| **carrier**            | í•­ê³µì‚¬ëª…                     |
| **tailnum**            | í•­ê³µê¸° ë“±ë¡ ì½”ë“œ             |
| **origin**             | ì¶œë°œ ê³µí•­                    |
| **dest**               | ë„ì°© ê³µí•­                    |
| **distance**           | ë¹„í–‰ ê±°ë¦¬                    |
| **seats**              | ì¢Œì„ ìˆ˜                      |

:::

------------------------------------------------------------------------

### 1. 3ê°œì˜ ê³µí•­ì—ì„œ ëª¨ë‘ ì¶œë°œí•˜ëŠ” í•­ê³µì‚¬

```{python}
#| echo: True
carrier_airport_count = merge_df.groupby('carrier')['origin'] \
    .nunique() \
    .reset_index() \
    .rename(columns={'origin': 'airport_count'})
carrier_airport_count.loc[carrier_airport_count['airport_count']==3, :]
carrier_airport_count_sorted=carrier_airport_count.sort_values(by='airport_count', ascending= False)
print(carrier_airport_count_sorted)
```

------------------------------------------------------------------------

### 2. í•­ê³µì‚¬ë³„ ìš´ì˜ íšŸìˆ˜

```{python}
#| echo: True

carrier_total_count = merge_df.pivot_table(
    index='carrier',
    values='year_x',
    aggfunc='count'
).reset_index()
carrier_total_count.sort_values(by='year_x',ascending=False)
carrier_total_count_sorted = carrier_total_count.sort_values(by='year_x',ascending=False)
print(carrier_total_count_sorted)
```

------------------------------------------------------------------------

### 3. í•­ê³µì‚¬ë³„ ë¹„í–‰ ê±°ë¦¬

```{python}
#| echo: True
total_distance = merge_df.groupby('carrier')['distance'].sum().reset_index()
total_distance_sorted = total_distance.sort_values(by="distance", ascending=False)
print(total_distance_sorted)
```

------------------------------------------------------------------------

### 4. í•­ê³µì‚¬ë³„ ë³´ìœ  í•­ê³µê¸° ìˆ˜

```{python}
#| echo: True
plane_count = merge_df.pivot_table(
    index='carrier', 
    values='tailnum',
    aggfunc='nunique'
).reset_index()
plane_count_sorted= plane_count.sort_values(by='tailnum' , ascending=False)
print(plane_count_sorted)
```

------------------------------------------------------------------------

### 5. í•­ê³µì‚¬ë³„ ì¢Œì„ ìˆ˜

```{python}
#| echo: True
unique_planes = merge_df[['carrier', 'tailnum', 'seats']].drop_duplicates()
total_seat_unique = unique_planes.groupby('carrier')['seats'].sum().reset_index()
total_seat_unique_sorted = total_seat_unique.sort_values(by='seats', ascending=False)
print(total_seat_unique_sorted)
```

------------------------------------------------------------------------

### ì¢…í•© - 5ëŒ€ í•­ê³µì‚¬ ì„ ì •

```{python}
#| echo: False
carrier_stats = pd.merge(carrier_total_count, total_distance, on='carrier')
carrier_stats = pd.merge(carrier_stats, plane_count, on='carrier')
carrier_stats = pd.merge(carrier_stats, total_seat_unique, on='carrier')


carrier_stats['flight_count_ratio'] = carrier_stats['year_x'] / carrier_stats['year_x'].max()
carrier_stats['total_distance_ratio'] = carrier_stats['distance'] / carrier_stats['distance'].max()
carrier_stats['plane_count_ratio'] = carrier_stats['tailnum'] / carrier_stats['tailnum'].max()
carrier_stats['total_seats_ratio'] = carrier_stats['seats'] / carrier_stats['seats'].max()

# -------------------------------------
# 7. ì´í•© ì ìˆ˜ ê³„ì‚° (ë¹„ìœ¨ í•©ì‚°)
# -------------------------------------
carrier_stats['total_score'] = (
    carrier_stats['flight_count_ratio'] +
    carrier_stats['total_distance_ratio'] +
    carrier_stats['plane_count_ratio'] +
    carrier_stats['total_seats_ratio']
)


# ì •ë ¬
carrier_stats_sorted = carrier_stats.sort_values(by='total_score', ascending=False)


# ìƒìœ„ 5ê°œ í•­ê³µì‚¬ë§Œ ì„ íƒ
top5_carrier_stats_sorted = carrier_stats_sorted.head(5)

# ë¦¬ìŠ¤íŠ¸ë¡œ ë½‘ì•„ì˜¤ê¸°
carriers = top5_carrier_stats_sorted['carrier'].tolist()
flight_count_ratio = top5_carrier_stats_sorted['flight_count_ratio'].tolist()
total_distance_ratio = top5_carrier_stats_sorted['total_distance_ratio'].tolist()
plane_count_ratio = top5_carrier_stats_sorted['plane_count_ratio'].tolist()
total_seats_ratio = top5_carrier_stats_sorted['total_seats_ratio'].tolist()

# Xì¶• ì¢Œí‘œ: ê·¸ëƒ¥ range() ì“°ê¸°
x = range(len(carriers))

# ê·¸ë˜í”„ í¬ê¸° ì„¤ì •
plt.figure(figsize=(17, 10))

# ê° í•­ëª©ì„ ìŠ¤íƒí•´ì„œ ë§‰ëŒ€ê·¸ë˜í”„ë¡œ ê·¸ë¦¬ê¸°
plt.bar(x, flight_count_ratio, label='ìš´í•­íšŸìˆ˜ ë¹„ìœ¨', color='skyblue', edgecolor='black')
plt.bar(x, total_distance_ratio, bottom=flight_count_ratio, label='ë¹„í–‰ê±°ë¦¬ ë¹„ìœ¨', color='orange', edgecolor='black')

# flight_count + total_distanceë¥¼ ë”í•´ì„œ bottom ì§€ì •
bottom_2 = [f + d for f, d in zip(flight_count_ratio, total_distance_ratio)]
plt.bar(x, plane_count_ratio, bottom=bottom_2, label='í•­ê³µê¸°ìˆ˜ ë¹„ìœ¨', color='green', edgecolor='black')

# bottom_3ì€ ì•ì˜ ì„¸ í•­ëª©ì„ ë‹¤ ë”í•´ì„œ ë§Œë“¤ê¸°
bottom_3 = [f + d + p for f, d, p in zip(flight_count_ratio, total_distance_ratio, plane_count_ratio)]
plt.bar(x, total_seats_ratio, bottom=bottom_3, label='ì¢Œì„ìˆ˜ ë¹„ìœ¨', color='purple', edgecolor='black')

# íƒ€ì´í‹€ ë° ë¼ë²¨ë§
plt.title('ê·œëª¨ ìƒìœ„ 5ê°œ í•­ê³µì‚¬ ì§€í‘œë³„ ê·¸ë˜í”„', fontsize=20)
plt.xlabel('í•­ê³µì‚¬ (Carrier)', fontsize=16)
plt.ylabel('ë¹„ìœ¨ í•©ì‚° (ì •ê·œí™”)', fontsize=16)

# Xì¶•ì— í•­ê³µì‚¬ ì´ë¦„ ë³´ì—¬ì£¼ê¸°
plt.xticks(x, carriers, rotation=45)

# ë²”ë¡€ ì¶”ê°€
plt.legend(loc='upper right', fontsize = 14)

# ë³´ì¡°ì„  ì¶”ê°€
plt.grid(axis='y', linestyle='--', alpha=0.5)

# xì¶• ì´ë¦„ í‚¤ìš°ê¸°
plt.xticks(fontsize=14)

plt.tight_layout()
plt.show()

```

<!-- # ì£¼ì œ2. ì£¼ì¤‘ê³¼ ì£¼ë§ ê°ê° ë”°ë¡œ ì¶”ì²œí•  í•­ê³µì‚¬ ì°¾ê¸° (ìµœëŒ“ê°’ ì •ê·œí™” ì ìš©) -->

# ìµœì  í•­ê³µì‚¬ ì¶”ì²œ

------------------------------------------------------------------------

## ì¶”ì²œ ê¸°ì¤€ & ì ìˆ˜ ì‚°ì • ë°©ì‹

### ê¸°ì¤€

-   ì£¼ì¤‘, ì£¼ë§ë³„ ì„¸ê°€ì§€ ê¸°ì¤€ë³„ë¡œ 100ì  ë§Œì ìœ¼ë¡œ ì •ê·œí™”
    1.  ì´ ìš´í•­ ìˆ˜
    2.  í‰ê·  ì§€ì—° ì‹œê°„
    3.  ì •ì‹œ ìš´í•­ ë¹„ìœ¨
    4.  ê²½ë¡œ ë‹¤ì–‘ì„±(ë„ì°©ì§€ ìˆ˜)

### ì ìˆ˜ ì‚°ì • ë°©ì‹

-   ê° ì§€í‘œë³„ ìµœëŒ“ê°’ ê¸°ì¤€ ì •ê·œí™”

| í•­ê³µì‚¬ | ìš´í•­ íšŸìˆ˜ | ì •ê·œí™” ê°’(ìš´í•­ íšŸìˆ˜ / ìµœëŒ€ê°’) |
|:------:|:---------:|:-----------------------------:|
|   AA   |  25,000   |     25,000 / 25,000 = 1.0     |
|   DL   |  20,000   |     20,000 / 25,000 = 0.8     |
|   UA   |  15,000   |     15,000 / 25,000 = 0.6     |

: **ìµœëŒ€ê°’ ê¸°ì¤€ ì •ê·œí™” ë°©ì‹ ì˜ˆì‹œ**

------------------------------------------------------------------------

## ë‚ ì§œ ì „ì²˜ë¦¬

```{python}
#| echo: True
# ìƒìœ„ 5ê°œ í•­ê³µì‚¬ í•„í„°ë§
top_carrier = ['UA', 'AA', 'B6', 'DL', 'EV']

# year ì¹¼ëŸ¼ëª… ì •ë¦¬ - ë‚ ì§œ ì „ì²˜ë¦¬ ìœ„í•´
merge_df = merge_df.rename(columns={
    'year_x': 'year',               # year_x â†’ year (ê¸°ë³¸ ì—°ë„)
    'year_y': 'year_manufactured',  # year_y â†’ year_manufactured (ì œì¡° ì—°ë„)
})

# ë‚ ì§œ ì „ì²˜ë¦¬ - date ì¹¼ëŸ¼ ì¶”ê°€
merge_df['date'] = pd.to_datetime(merge_df[['year', 'month', 'day']])
# ìš”ì¼ ì¹¼ëŸ¼ ì¶”ê°€
merge_df['weekday'] = merge_df['date'].dt.day_name()

weekday_list = ["Monday", "Tuesday", "Wednesday", "Thursday"]
weekend_list = ["Friday", "Saturday", "Sunday"]

def week_group(weekday): # ì£¼ì¤‘, ì£¼ë§ êµ¬ë¶„ í•¨ìˆ˜
    if weekday in weekday_list:
        return "Weekday"
    else:
        return "Weekend"

merge_df['week_group'] = merge_df['weekday'].apply(week_group) # ì£¼ì¤‘, ì£¼ë§ ì¹¼ëŸ¼ ì¶”ê°€

# ìƒìœ„ 5ê°œ í•­ê³µì‚¬ ë°ì´í„° í•„í„°ë§
top5_df = merge_df[merge_df['carrier'].isin(top_carrier)]

# ì£¼ì¤‘, ì£¼ë§ ë°ì´í„° ë¶„ë¦¬
weekday_df = top5_df[top5_df['week_group'] == 'Weekday']
weekend_df = top5_df[top5_df['week_group'] == 'Weekend']
```

## í•­ê³µì‚¬ ë¶„ì„ - ì£¼ì¤‘

```{python}
# 1-1. ì£¼ì¤‘ ìš´í•­ ìˆ˜ ê³„ì‚°
weekday_flights = weekday_df.groupby('carrier')['flight'].count().reset_index()
weekday_flights = weekday_flights.sort_values(by='flight', ascending=False)
# ìµœëŒ“ê°’ ì •ê·œí™”
weekday_flights['flight_norm'] = weekday_flights['flight'] / weekday_flights['flight'].max()
weekday_flights = weekday_flights.rename(columns={'flight': 'weekday_flights'})

# 1-2. ì£¼ì¤‘ ê²½ë¡œ ë‹¤ì–‘ì„± - ë„ì°©ì§€ ì¢…ë¥˜ ìˆ˜ ê³„ì‚°
weekday_dest_diversity = weekday_df.groupby('carrier')['dest'].nunique().reset_index()
weekday_dest_diversity = weekday_dest_diversity.sort_values(by='dest', ascending=False)
# ìµœëŒ“ê°’ ì •ê·œí™”
weekday_dest_diversity['dest_norm'] = weekday_dest_diversity['dest'] / weekday_dest_diversity['dest'].max()
weekday_dest_diversity = weekday_dest_diversity.rename(columns={'dest': 'dest_count'})

# 1-3. ì£¼ì¤‘ í‰ê·  ì§€ì—° ì‹œê°„ ê³„ì‚° (ì§€ì—°ì‹œê°„ì€ ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)
weekday_delay_avg = weekday_df.groupby('carrier')['dep_delay'].mean().reset_index()
# ìµœì†Ÿê°’ì´ ê°€ì¥ ì¢‹ì€ ê°’ì´ ë˜ë„ë¡ ì—­ìˆ˜ ë³€í™˜
weekday_delay_avg['inverse_delay'] = 1 / (weekday_delay_avg['dep_delay'] + 1)  # +1ì€ 0ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì„ ë°©ì§€
# ìµœëŒ“ê°’ ì •ê·œí™”
weekday_delay_avg['delay_norm'] = weekday_delay_avg['inverse_delay'] / weekday_delay_avg['inverse_delay'].max()
weekday_delay_avg = weekday_delay_avg.rename(columns={'dep_delay': 'avg_delay'})

# 1-4. ì£¼ì¤‘ ì •ì‹œ ìš´í•­ ë¹„ìœ¨ ê³„ì‚° (ì¶œë°œ ì§€ì—° ê¸°ì¤€, Â±5ë¶„)
weekday_on_time = weekday_df[(weekday_df['dep_delay'] >= -5) & (weekday_df['dep_delay'] <= 5)]
weekday_on_time_ratio = weekday_on_time.groupby('carrier')['flight'].count().reset_index()
weekday_total_flights = weekday_df.groupby('carrier')['flight'].count().reset_index()
weekday_on_time_ratio = pd.merge(weekday_on_time_ratio, weekday_total_flights, on='carrier', suffixes=('_ontime', '_total'))
weekday_on_time_ratio['ratio'] = weekday_on_time_ratio['flight_ontime'] / weekday_on_time_ratio['flight_total'] * 100
# ìµœëŒ“ê°’ ì •ê·œí™”
weekday_on_time_ratio['ontime_norm'] = weekday_on_time_ratio['ratio'] / weekday_on_time_ratio['ratio'].max()
weekday_on_time_ratio = weekday_on_time_ratio[['carrier', 'ratio', 'ontime_norm']]
weekday_on_time_ratio = weekday_on_time_ratio.rename(columns={'ratio': 'ontime_ratio'})

# ì£¼ì¤‘ ì§€í‘œ ë³‘í•©í•˜ì—¬ ìµœì¢… ì¢…í•© ì ìˆ˜ ê³„ì‚°
weekday_ranking = pd.merge(weekday_flights[['carrier', 'weekday_flights', 'flight_norm']], 
                          weekday_dest_diversity[['carrier', 'dest_count', 'dest_norm']], 
                          on='carrier')
weekday_ranking = pd.merge(weekday_ranking, 
                          weekday_delay_avg[['carrier', 'avg_delay', 'delay_norm']], 
                          on='carrier')
weekday_ranking = pd.merge(weekday_ranking, 
                          weekday_on_time_ratio[['carrier', 'ontime_ratio', 'ontime_norm']], 
                          on='carrier')

# ì£¼ì¤‘ ì¢…í•© ì ìˆ˜ ê³„ì‚° (ìµœëŒ“ê°’ ì •ê·œí™” í•©ì‚°)
weekday_ranking['total_norm'] = (weekday_ranking['flight_norm'] + 
                                weekday_ranking['dest_norm'] + 
                                weekday_ranking['delay_norm'] + 
                                weekday_ranking['ontime_norm'])

# ì¢…í•© ì ìˆ˜ë¡œ ì •ë ¬
weekday_ranking = weekday_ranking.sort_values(by='total_norm', ascending=False)
weekday_ranking['final_rank'] = range(1, len(weekday_ranking) + 1)

# ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€ë§Œ í‘œì‹œí•˜ë„ë¡ í¬ë§·íŒ…
weekday_norm_columns = ['flight_norm', 'dest_norm', 'delay_norm', 'ontime_norm', 'total_norm']
weekday_ranking[weekday_norm_columns] = weekday_ranking[weekday_norm_columns].round(2)
print(weekday_ranking)

```

<br>

::: {.fragment style="display: flex; justify-content: flex-start;"}

|                    |                           |
|--------------------|---------------------------|
| **weekday_flight** | ì´ ìš´í•­ ìˆ˜                |
| **dest_count**     | ë„ì°©ì§€ ì¢…ë¥˜ ìˆ˜            |
| **avg_delay**      | í‰ê·  ì¶œë°œ ì§€ì—° ì‹œê°„       |
| **ontime_ratio**   | ì •ì‹œ ìš´í•­ ë¹„ìœ¨(ì •ì‹œì—ì„œ Â±5ë¶„ ì´ë‚´) |
| **total_norm**     | ì •ê·œí™” ì ìˆ˜ í•©ì‚°          |
| **final_rank**     | ìµœì¢… ìˆœìœ„                 |

:::

## í•­ê³µì‚¬ ë¶„ì„ - ì£¼ë§

```{python}
# 2-1. ì£¼ë§ ìš´í•­ ìˆ˜ ê³„ì‚°
weekend_flights = weekend_df.groupby('carrier')['flight'].count().reset_index()
weekend_flights = weekend_flights.sort_values(by='flight', ascending=False)
# ìµœëŒ“ê°’ ì •ê·œí™”
weekend_flights['flight_norm'] = weekend_flights['flight'] / weekend_flights['flight'].max()
weekend_flights = weekend_flights.rename(columns={'flight': 'weekend_flights'})

# 2-2. ì£¼ë§ ê²½ë¡œ ë‹¤ì–‘ì„± - ë„ì°©ì§€ ì¢…ë¥˜ ìˆ˜ ê³„ì‚°
weekend_dest_diversity = weekend_df.groupby('carrier')['dest'].nunique().reset_index()
weekend_dest_diversity = weekend_dest_diversity.sort_values(by='dest', ascending=False)
# ìµœëŒ“ê°’ ì •ê·œí™”
weekend_dest_diversity['dest_norm'] = weekend_dest_diversity['dest'] / weekend_dest_diversity['dest'].max()
weekend_dest_diversity = weekend_dest_diversity.rename(columns={'dest': 'dest_count'})

# 2-3. ì£¼ë§ í‰ê·  ì§€ì—° ì‹œê°„ ê³„ì‚° (ì§€ì—°ì‹œê°„ì€ ë‚®ì„ìˆ˜ë¡ ì¢‹ìŒ)
weekend_delay_avg = weekend_df.groupby('carrier')['dep_delay'].mean().reset_index()
# ìµœì†Ÿê°’ì´ ê°€ì¥ ì¢‹ì€ ê°’ì´ ë˜ë„ë¡ ì—­ìˆ˜ ë³€í™˜
weekend_delay_avg['inverse_delay'] = 1 / (weekend_delay_avg['dep_delay'] + 1)  # +1ì€ 0ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì„ ë°©ì§€
# ìµœëŒ“ê°’ ì •ê·œí™”
weekend_delay_avg['delay_norm'] = weekend_delay_avg['inverse_delay'] / weekend_delay_avg['inverse_delay'].max()
weekend_delay_avg = weekend_delay_avg.rename(columns={'dep_delay': 'avg_delay'})

# 2-4. ì£¼ë§ ì •ì‹œ ìš´í•­ ë¹„ìœ¨ ê³„ì‚° (ì¶œë°œ ì§€ì—° ê¸°ì¤€, Â±5ë¶„)
weekend_on_time = weekend_df[(weekend_df['dep_delay'] >= -5) & (weekend_df['dep_delay'] <= 5)]
weekend_on_time_ratio = weekend_on_time.groupby('carrier')['flight'].count().reset_index()
weekend_total_flights = weekend_df.groupby('carrier')['flight'].count().reset_index()
weekend_on_time_ratio = pd.merge(weekend_on_time_ratio, weekend_total_flights, on='carrier', suffixes=('_ontime', '_total'))
weekend_on_time_ratio['ratio'] = weekend_on_time_ratio['flight_ontime'] / weekend_on_time_ratio['flight_total'] * 100
# ìµœëŒ“ê°’ ì •ê·œí™”
weekend_on_time_ratio['ontime_norm'] = weekend_on_time_ratio['ratio'] / weekend_on_time_ratio['ratio'].max()
weekend_on_time_ratio = weekend_on_time_ratio[['carrier', 'ratio', 'ontime_norm']]
weekend_on_time_ratio = weekend_on_time_ratio.rename(columns={'ratio': 'ontime_ratio'})

# ì£¼ë§ ì§€í‘œ ë³‘í•©í•˜ì—¬ ìµœì¢… ì¢…í•© ì ìˆ˜ ê³„ì‚°
weekend_ranking = pd.merge(weekend_flights[['carrier', 'weekend_flights', 'flight_norm']], 
                          weekend_dest_diversity[['carrier', 'dest_count', 'dest_norm']], 
                          on='carrier')
weekend_ranking = pd.merge(weekend_ranking, 
                          weekend_delay_avg[['carrier', 'avg_delay', 'delay_norm']], 
                          on='carrier')
weekend_ranking = pd.merge(weekend_ranking, 
                          weekend_on_time_ratio[['carrier', 'ontime_ratio', 'ontime_norm']], 
                          on='carrier')

# ì£¼ë§ ì¢…í•© ì ìˆ˜ ê³„ì‚° (ìµœëŒ“ê°’ ì •ê·œí™” í•©ì‚°)
weekend_ranking['total_norm'] = (weekend_ranking['flight_norm'] + 
                                weekend_ranking['dest_norm'] + 
                                weekend_ranking['delay_norm'] + 
                                weekend_ranking['ontime_norm'])

# ì¢…í•© ì ìˆ˜ë¡œ ì •ë ¬
weekend_ranking = weekend_ranking.sort_values(by='total_norm', ascending=False)
weekend_ranking['final_rank'] = range(1, len(weekend_ranking) + 1)

# ì†Œìˆ˜ì  ë‘˜ì§¸ ìë¦¬ê¹Œì§€ë§Œ í‘œì‹œí•˜ë„ë¡ í¬ë§·íŒ…
weekend_norm_columns = ['flight_norm', 'dest_norm', 'delay_norm', 'ontime_norm', 'total_norm']
weekend_ranking[weekend_norm_columns] = weekend_ranking[weekend_norm_columns].round(2)
print(weekend_ranking)
```

<br>

::: {.fragment style="display: flex; justify-content: flex-start;"}

|                    |                           |
|--------------------|---------------------------|
| **weekend_flight** | ì´ ìš´í•­ ìˆ˜                |
| **dest_count**     | ë„ì°©ì§€ ì¢…ë¥˜ ìˆ˜            |
| **avg_delay**      | í‰ê·  ì¶œë°œ ì§€ì—° ì‹œê°„       |
| **ontime_ratio**   | ì •ì‹œ ìš´í•­ ë¹„ìœ¨(ì •ì‹œì—ì„œ Â±5ë¶„ ì´ë‚´) |
| **total_norm**     | ì •ê·œí™” ì ìˆ˜ í•©ì‚°          |
| **final_rank**     | ìµœì¢… ìˆœìœ„                 |

:::

## ê²°ë¡ 

::: panel-tabset
### ìŠ¤íƒ ë§‰ëŒ€ ê·¸ë˜í”„

```{python}
# 2. ì£¼ì¤‘/ì£¼ë§ ìŠ¤íƒ ë§‰ëŒ€ ê·¸ë˜í”„ - ì˜ì—­ë³„ ì ìˆ˜
plt.figure(figsize=(15, 8))
plt.subplot(1, 2, 1)
bottom_values = np.zeros(len(weekday_ranking))

# í•­ê³µì‚¬ë¥¼ ì£¼ì¤‘ ì´ì  ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
weekday_sorted = weekday_ranking.sort_values(by='total_norm', ascending=False)

# ë¶€ë¬¸ë³„ ìƒ‰ìƒ ì •ì˜
colors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728']
sections = ['flight_norm', 'dest_norm', 'delay_norm', 'ontime_norm']
section_names = ['ìš´í•­ ìˆ˜', 'ê²½ë¡œ ë‹¤ì–‘ì„±', 'ì§€ì—° ì‹œê°„', 'ì •ì‹œ ìš´í•­']

# ìŠ¤íƒ ë°” ì°¨íŠ¸ ìƒì„±
for i, section in enumerate(sections):
    plt.bar(weekday_sorted['carrier'], weekday_sorted[section], bottom=bottom_values, 
            label=section_names[i], color=colors[i])
    bottom_values += weekday_sorted[section].values

plt.xlabel('í•­ê³µì‚¬')
plt.ylabel('ì •ê·œí™”ëœ ê°’ (0~1)')
plt.title('ì£¼ì¤‘ í•­ê³µì‚¬ë³„ ë¶€ë¬¸ ì ìˆ˜ ë¹„êµ (ìµœëŒ“ê°’ ì •ê·œí™”)', fontsize = 20)
plt.legend(loc='upper right')

# ê° ë§‰ëŒ€ ìœ„ì— ì´ì  í‘œì‹œ
for i, carrier in enumerate(weekday_sorted['carrier']):
    plt.text(i, weekday_sorted.iloc[i]['total_norm']+0.01 , 
             f"{weekday_sorted.iloc[i]['total_norm']:.2f}", 
             ha='center',
             fontsize = 13)
plt.xticks(fontsize = 20)
# 3. ì£¼ë§ ìŠ¤íƒ ë§‰ëŒ€ ê·¸ë˜í”„ - ì˜ì—­ë³„ ì ìˆ˜
plt.subplot(1, 2, 2)
bottom_values = np.zeros(len(weekend_ranking))

# í•­ê³µì‚¬ë¥¼ ì£¼ë§ ì´ì  ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
weekend_sorted = weekend_ranking.sort_values(by='total_norm', ascending=False)

# ìŠ¤íƒ ë°” ì°¨íŠ¸ ìƒì„±
for i, section in enumerate(sections):
    plt.bar(weekend_sorted['carrier'], weekend_sorted[section], bottom=bottom_values, 
            label=section_names[i], color=colors[i])
    bottom_values += weekend_sorted[section].values

plt.xlabel('í•­ê³µì‚¬')
plt.ylabel('ì •ê·œí™”ëœ ê°’ (0~1)')
plt.title('ì£¼ë§ í•­ê³µì‚¬ë³„ ë¶€ë¬¸ ì ìˆ˜ ë¹„êµ (ìµœëŒ“ê°’ ì •ê·œí™”)', fontsize = 20)
plt.legend(loc='upper right')

# ê° ë§‰ëŒ€ ìœ„ì— ì´ì  í‘œì‹œ
for i, carrier in enumerate(weekend_sorted['carrier']):
    plt.text(i, weekend_sorted.iloc[i]['total_norm'] + 0.01, 
             f"{weekend_sorted.iloc[i]['total_norm']:.2f}", 
             ha='center',
             fontsize = 13)
plt.xticks(fontsize = 20)
plt.tight_layout()
plt.show()
```

### ë ˆì´ë” ì°¨íŠ¸

```{python}
# 4. ì£¼ì¤‘/ì£¼ë§ ë ˆì´ë” ì°¨íŠ¸
'''
ìš°ë¦¬ê°€ ìˆ˜ì—…ì—ì„œ ì•ˆë°°ìš´ ê²ƒ ì„¤ëª… - ë ˆì´ë” ì°¨íŠ¸

ë ˆì´ë” ì°¨íŠ¸ë€?
ì—¬ëŸ¬ ê°œì˜ ë³€ìˆ˜ë¥¼ í•œëˆˆì— ë¹„êµí•  ìˆ˜ ìˆë„ë¡ ë°©ì‚¬í˜•(ê±°ë¯¸ì¤„ í˜•íƒœ)ìœ¼ë¡œ ë°°ì¹˜í•œ ê·¸ë˜í”„
ê° ì¶•ì€ ì„œë¡œ ë‹¤ë¥¸ ë³€ìˆ˜ë¥¼ ë‚˜íƒ€ëƒ„
ë°ì´í„° ê°’ì„ ì ìœ¼ë¡œ í‘œì‹œí•œ í›„, ì„ ìœ¼ë¡œ ì—°ê²°í•˜ì—¬ ë‹¤ê°í˜• ëª¨ì–‘ì„ ë§Œë“¦

ğŸ¯ ì–¸ì œ ì‚¬ìš©í• ê¹Œ?
ì—¬ëŸ¬ ê°€ì§€ íŠ¹ì„±ì„ ë¹„êµí•  ë•Œ
ê°•ì ê³¼ ì•½ì ì„ ì‹œê°ì ìœ¼ë¡œ ì‰½ê²Œ í™•ì¸í•  ë•Œ
-> ë§Œí™”ë‚˜ ê²Œì„ê°™ì€ë°ì„œ ìºë¦­í„° ëŠ¥ë ¥ì¹˜ê°™ì€ê±° ë‚˜íƒ€ë‚¼ë•Œ í•œë²ˆì¯¤ ë³¸ê±°

âš¡ ì¥ì :
âœ” ì—¬ëŸ¬ ë³€ìˆ˜ ë¹„êµ ê°€ëŠ¥
âœ” ì‹œê°ì ìœ¼ë¡œ ì´í•´í•˜ê¸° ì‰¬ì›€

âš  ë‹¨ì :
âŒ ë§ì€ ë³€ìˆ˜ê°€ ìˆìœ¼ë©´ ë³µì¡í•´ì§

matplotlib ê¸°ë³¸ ë°©ë²• â†’ íŒŒì´ì¬ ê¸°ì¤€ ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦´ë•Œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë°©ì‹
seaborn -> ì—†ìŒ. ìƒ‰ê° ê°œì„ ì— ê°™ì´ ì“¸ìˆ˜ëŠ” ìˆë‹¤í•¨
'''
plt.figure(figsize=(15, 7)) # ê°€ë¡œ(width) 15, ì„¸ë¡œ(height) 7 í¬ê¸°ë¡œ ê·¸ë˜í”„ ì˜ì—­ ìƒì„±

# ì£¼ì¤‘ ë ˆì´ë” ì°¨íŠ¸
plt.subplot(1, 2, 1, polar=True)
# 1í–‰ 2ì—´ì§œë¦¬ ê·¸ë˜í”„ ì¤‘ì—ì„œ ì²« ë²ˆì§¸ ê·¸ë˜í”„ë¥¼ ìƒì„±
# ì¼ë°˜ì ì¸ x-y ì¢Œí‘œ ê·¸ë˜í”„ê°€ ì•„ë‹ˆë¼ ê·¹ì¢Œí‘œ(polar) ê·¸ë˜í”„ë¥¼ ìƒì„± - > ë ˆì´ë” ì°¨íŠ¸
# ê·¹ì¢Œí‘œ ê·¸ë˜í”„ : xì¶•,yì¶•ì´ ì•„ë‹ˆë¼ ê±°ë¦¬ì™€ ê°ë„ë¡œ í‘œí˜„ë˜ëŠ” ê·¸ë˜í”„-> ë‚˜ì¹¨ë°˜ ë°ì´í„°ê°™ì€ê±°

categories = section_names # ì£¼ì¤‘ ìŠ¤íƒ ë§‰ëŒ€ê·¸ë˜í”„ ë§Œë“¤ë•Œ ë§Œë“  ë¶€ë¬¸ë³„ ë¦¬ìŠ¤íŠ¸ë¥¼ categories ë³€ìˆ˜ì— ì €ì¥
N = len(categories) # ì¹´í…Œê³ ë¦¬ ê°œìˆ˜(N) ê³„ì‚°. ì—¬ê¸°ì„  4

# ê°ë„ ê³„ì‚°
angles = [n / float(N) * 2 * np.pi for n in range(N)]
# nì„ Nìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë¹„ìœ¨(0 ~ 1) ê³„ì‚°
# 1 ë¼ë””ì•ˆ : í˜¸ì˜ ê¸¸ì´ = ì›ì˜ ë°˜ì§€ë¦„ì¼ë•Œ ì¤‘ì‹¬ê°
# 2 * np.pi â†’ ë¹„ìœ¨ì„ 360ë„(2Ï€ ë¼ë””ì•ˆ)ë¡œ ë³€í™˜
# Nê°œì˜ ì¹´í…Œê³ ë¦¬ë¥¼ 360ë„(2íŒŒì´ ë¼ë””ì•ˆ)ë¡œ ê· ë“±í•˜ê²Œ ë°°ë¶„í•˜ì—¬ ê°ë„ ê³„ì‚°
# n / float(N) * 2 * np.pi â†’ ê° ì§€í‘œì˜ ê°ë„(Î¸) ê³„ì‚° ê³µì‹
# 4ê°œë‹ˆê¹Œ ì˜¤ë¥¸ìª½ (0Â°), ìœ„ìª½ (90Â°),  ì™¼ìª½ (180Â°), ì•„ë˜ìª½ (270Â°)
# 4ê°œì˜ ì ì´ ì›ì„ 4ë“±ë¶„í•œ ìœ„ì¹˜ì— ë°°ì¹˜
angles += angles[:1]  # ë‹«íŒ ë‹¤ê°í˜•ì„ ìœ„í•´ ì²˜ìŒ ê°’ ë°˜ë³µ
# ë ˆì´ë” ì°¨íŠ¸ëŠ” ë‹«íŒ ë‹¤ê°í˜•(Polygon)ì´ ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.
# ì´ë¥¼ ìœ„í•´ ì²« ë²ˆì§¸ ê°’ì„ ë‹¤ì‹œ ì¶”ê°€í•˜ì—¬ ê·¸ë˜í”„ê°€ ì›í˜•ìœ¼ë¡œ ì´ì–´ì§€ë„ë¡ í•©ë‹ˆë‹¤.


# xì¶• ë¼ë²¨ ì„¤ì •
plt.xticks(angles[:-1], categories, size=13)
# ë ˆì´ë” ì°¨íŠ¸ xì¶•(ê°ë„ ë°©í–¥) ì„¤ì •
#     ticks: ëˆˆê¸ˆì˜ ìœ„ì¹˜ (ê°ë„ ê°’, angles[:-1])
#     labels: ëˆˆê¸ˆì— í‘œì‹œí•  ë ˆì´ë¸” (ì¹´í…Œê³ ë¦¬ëª…, categories)
#     size: ê¸€ì”¨ í¬ê¸° ì„¤ì • (10pt)


# yì¶• ë²”ìœ„ ì„¤ì •
plt.ylim(0, 1)  # ìµœëŒ“ê°’ ì •ê·œí™” ê²°ê³¼ëŠ” 0~1 ì‚¬ì´. ì œì¼ ëì´ 1

# ê° í•­ê³µì‚¬ë³„ ìƒ‰ìƒ -> ë ˆì´ë” ì°¨íŠ¸ ì„ 
carrier_colors = {
    'UA': 'royalblue',
    'AA': 'tomato',
    'B6': 'forestgreen',
    'DL': 'purple',
    'EV': 'orange'
}

# ê° í•­ê³µì‚¬ì— ëŒ€í•œ ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦¬ê¸°
for i, row in weekday_ranking.iterrows():
    carrier = row['carrier']
    values = [row['flight_norm'], row['dest_norm'], row['delay_norm'], row['ontime_norm']]
    values += values[:1]  # ë‹«íŒ ë‹¤ê°í˜•ì„ ìœ„í•´ ì²˜ìŒ ê°’ ë°˜ë³µ
    
    # ì„  ê·¸ë¦¬ê¸°
    plt.plot(angles, values, linewidth=2, linestyle='solid', color=carrier_colors[carrier], label=carrier)
    # ì˜ì—­ ì±„ìš°ê¸°
    plt.fill(angles, values, alpha=0.1, color=carrier_colors[carrier])

# weekday_ranking.iterrows()ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° í•­ê³µì‚¬ì˜ ë°ì´í„°ë¥¼ í•˜ë‚˜ì”© ê°€ì ¸ì˜´.
# iterrows() : DataFrameì—ì„œ ê° í–‰ì„ ë°˜ë³µ(iterate)í•˜ë©° ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜ #ì´í„°ë ˆì´íŠ¸
# row['carrier']: í•­ê³µì‚¬ ì´ë¦„ (ì˜ˆ: 'UA', 'AA', 'B6' ë“±)
# values = [...]: í•´ë‹¹ í•­ê³µì‚¬ì˜ ì •ê·œí™”ëœ ì ìˆ˜ ë¦¬ìŠ¤íŠ¸ ìƒì„±.
    # flight_norm: ìš´í•­ ìˆ˜ ì ìˆ˜ (100ì  ë§Œì  ì •ê·œí™”)
    # dest_norm: ê²½ë¡œ ë‹¤ì–‘ì„± ì ìˆ˜
    # delay_norm: ì§€ì—° ì‹œê°„ ì ìˆ˜
    # ontime_norm: ì •ì‹œ ìš´í•­ ì ìˆ˜
# values += values[:1]: ì²« ë²ˆì§¸ ê°’ì„ ë§ˆì§€ë§‰ì— ì¶”ê°€í•˜ì—¬ ë‹«íŒ ë‹¤ê°í˜•ì„ ë§Œë“¦.

# linewidth=2: ì„  ë‘ê»˜ ì„¤ì •
# linestyle='solid': ì‹¤ì„  ìŠ¤íƒ€ì¼ (--, -., :ë„ ê°€ëŠ¥)
# color=carrier_colors[carrier]: í•­ê³µì‚¬ë³„ ìƒ‰ìƒ ì ìš©
# label=carrier: ë²”ë¡€ í‘œì‹œ

# plt.fill()ì„ ì‚¬ìš©í•˜ì—¬ ë ˆì´ë” ì°¨íŠ¸ ë‚´ë¶€ ì˜ì—­ì„ ë¶€ë“œëŸ½ê²Œ ì±„ì›€.
# alpha=0.1 â†’ íˆ¬ëª…ë„ ì¡°ì ˆ (0: ì™„ì „ íˆ¬ëª…, 1: ë¶ˆíˆ¬ëª…)
# color=carrier_colors[carrier] â†’ í•­ê³µì‚¬ë³„ ìƒ‰ìƒ ì ìš©


plt.title('ì£¼ì¤‘ í•­ê³µì‚¬ ë¶€ë¬¸ë³„ ì •ê·œí™” ì ìˆ˜', pad=30, fontsize = 18) #pad : ìœ„ìª½ ì—¬ë°±
plt.legend(loc='upper right')

# ì£¼ë§ ë ˆì´ë” ì°¨íŠ¸
plt.subplot(1, 2, 2, polar=True)
# 1í–‰ 2ì—´ì§œë¦¬ ê·¸ë˜í”„ ì¤‘ì—ì„œ ë‘ ë²ˆì§¸ ê·¸ë˜í”„ë¥¼ ìƒì„±

# xì¶• ë¼ë²¨ ì„¤ì •
plt.xticks(angles[:-1], categories, size=13)

# yì¶• ë²”ìœ„ ì„¤ì •
plt.ylim(0, 1)  # ìµœëŒ“ê°’ ì •ê·œí™” ê²°ê³¼ëŠ” 0~1 ì‚¬ì´

# ê° í•­ê³µì‚¬ì— ëŒ€í•œ ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦¬ê¸°
for i, row in weekend_ranking.iterrows():
    carrier = row['carrier']
    values = [row['flight_norm'], row['dest_norm'], row['delay_norm'], row['ontime_norm']]
    values += values[:1]  # ë‹«íŒ ë‹¤ê°í˜•ì„ ìœ„í•´ ì²˜ìŒ ê°’ ë°˜ë³µ
    
    # ì„  ê·¸ë¦¬ê¸°
    plt.plot(angles, values, linewidth=2, linestyle='solid', color=carrier_colors[carrier], label=carrier)
    # ì˜ì—­ ì±„ìš°ê¸°
    plt.fill(angles, values, alpha=0.1, color=carrier_colors[carrier])

plt.title('ì£¼ë§ í•­ê³µì‚¬ ë¶€ë¬¸ë³„ ì •ê·œí™” ì ìˆ˜', pad=30,fontsize = 18) 
plt.legend(loc='upper right') # ë²”ë¡€ì„¤ì •, locìœ¼ë¡œ ë²”ë¡€ ìœ„ì¹˜ ì„¤ì •

plt.tight_layout()
plt.show()

```

### ë ˆì´ë” ì°¨íŠ¸ ì½”ë“œ

``` python
# ì£¼ì¤‘/ì£¼ë§ ë ˆì´ë” ì°¨íŠ¸
plt.figure(figsize=(15, 7)) 

# ì£¼ì¤‘ ë ˆì´ë” ì°¨íŠ¸
plt.subplot(1, 2, 1, polar=True)  # ê·¹ì¢Œí‘œ(polar) ê·¸ë˜í”„ ìƒì„±
categories = section_names 
N = len(categories)

# ê°ë„ ê³„ì‚°
angles = [n / float(N) * 2 * np.pi for n in range(N)]
angles += angles[:1]  # ë‹«íŒ ë‹¤ê°í˜•ì„ ìœ„í•´ ì²˜ìŒ ê°’ ë°˜ë³µ

# xì¶• ë¼ë²¨ ì„¤ì •
plt.xticks(angles[:-1], categories, size=10)


# yì¶• ë²”ìœ„ ì„¤ì •
plt.ylim(0, 1)    # ìµœëŒ“ê°’ ì •ê·œí™” ê²°ê³¼ëŠ” 0~1 ì‚¬ì´. ì œì¼ ëì´ 1

# ê° í•­ê³µì‚¬ë³„ ìƒ‰ìƒ -> ë ˆì´ë” ì°¨íŠ¸ ì„ 
carrier_colors = {
    'UA': 'royalblue',
    'AA': 'tomato',
    'B6': 'forestgreen',
    'DL': 'purple',
    'EV': 'orange'
}

# ê° í•­ê³µì‚¬ì— ëŒ€í•œ ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦¬ê¸°
for i, row in weekday_ranking.iterrows():
    carrier = row['carrier']
    values = [row['flight_norm'], row['dest_norm'], row['delay_norm'], row['ontime_norm']]
    values += values[:1]    # ë‹«íŒ ë‹¤ê°í˜•ì„ ìœ„í•´ ì²˜ìŒ ê°’ ë°˜ë³µ
    
    # ì„  ê·¸ë¦¬ê¸°
    plt.plot(angles, values, linewidth=2, linestyle='solid', color=carrier_colors[carrier], label=carrier)
    # ì˜ì—­ ì±„ìš°ê¸°
    plt.fill(angles, values, alpha=0.1, color=carrier_colors[carrier])

plt.title('ì£¼ì¤‘ í•­ê³µì‚¬ ë¶€ë¬¸ë³„ ì •ê·œí™” ì ìˆ˜', pad=30)
plt.legend(loc='upper right')

# ì£¼ë§ ë ˆì´ë” ì°¨íŠ¸
plt.subplot(1, 2, 2, polar=True)

# xì¶• ë¼ë²¨ ì„¤ì •
plt.xticks(angles[:-1], categories, size=10)

# yì¶• ë²”ìœ„ ì„¤ì •
plt.ylim(0, 1)  

# ê° í•­ê³µì‚¬ì— ëŒ€í•œ ë ˆì´ë” ì°¨íŠ¸ ê·¸ë¦¬ê¸°
for i, row in weekend_ranking.iterrows():
    carrier = row['carrier']
    values = [row['flight_norm'], row['dest_norm'], row['delay_norm'], row['ontime_norm']]
    values += values[:1]    # ë‹«íŒ ë‹¤ê°í˜•ì„ ìœ„í•´ ì²˜ìŒ ê°’ ë°˜ë³µ
    
    # ì„  ê·¸ë¦¬ê¸°
    plt.plot(angles, values, linewidth=2, linestyle='solid', color=carrier_colors[carrier], label=carrier)
    # ì˜ì—­ ì±„ìš°ê¸°
    plt.fill(angles, values, alpha=0.1, color=carrier_colors[carrier])

plt.title('ì£¼ë§ í•­ê³µì‚¬ ë¶€ë¬¸ë³„ ì •ê·œí™” ì ìˆ˜', pad=30) 
plt.legend(loc='upper right')   # ë²”ë¡€ì„¤ì •, locìœ¼ë¡œ ë²”ë¡€ ìœ„ì¹˜ ì„¤ì •

plt.tight_layout()
plt.show()
```
:::

# ì¡°ì› ë° ì—…ë¬´ ë¶„ë‹´

## ì¡°ì› ë° ì—…ë¬´ ë¶„ë‹´

+--------------+-------------------------------------------------------------------------+
| **ì´ì£¼ì—°**   | -   **í•­ê³µì‚¬ ê·œëª¨ ë¶„ì„** : ì¶œë°œ ê³µí•­, ìš´ì˜ íšŸìˆ˜                         |
|              |                                                                         |
|              | -   qmd ì œì‘ ë° ë°œí‘œ                                                    |
+--------------+-------------------------------------------------------------------------+
| **ì‹ ì§€ì›**   | -   **í•­ê³µì‚¬ ê·œëª¨ ë¶„ì„** : ë¹„í–‰ ê±°ë¦¬, ë³´ìœ  í•­ê³µê¸° ìˆ˜ , ì¢Œì„ ìˆ˜          |
|              |                                                                         |
|              | -   5ëŒ€ í•­ê³µì‚¬ ì„ ì • ì‹œê°í™”                                              |
+--------------+-------------------------------------------------------------------------+
| **í™ì£¼í˜•**   | -   **5ëŒ€ í•­ê³µì‚¬ ë°ì´í„° ë¶„ì„** : (ì£¼ì¤‘/ì£¼ë§) ë¶€ë¬¸ë³„ ì ìˆ˜ ì‚°ì • ë° ì‹œê°í™” |
+--------------+-------------------------------------------------------------------------+
| **í•œê·œë¯¼**   | -   **5ëŒ€ í•­ê³µì‚¬ ë°ì´í„° ë¶„ì„** : (ì£¼ì¤‘/ì£¼ë§) ë¶€ë¬¸ë³„ ì ìˆ˜ ì‚°ì • ë° ì‹œê°í™” |
+--------------+-------------------------------------------------------------------------+

# Thank you!